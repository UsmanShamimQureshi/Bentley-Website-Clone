define("abstracts/AbstractApplication",["require","jquery","marionette"],function(g){var f=g("jquery"),d=g("marionette");return d.Application.extend({config:{stateClass:{loading:"by_loading",error:"by_error",active:"by_active",enabled:"by_enabled",disabled:"by_disabled",expanded:"by_expanded",fixed:"by_fixed",transition:"by_transition",reverseTransition:"by_reverse",hidden:"by_hidden",empty:"by_empty"},source:{},revision:{}},i18nCache:{},appName:void 0,layout:void 0,regions:{},state:void 0,actions:void 0,
data:{},_alreadyRun:!1,initialize:function(){this.appConfig&&f.extend(this.config,this.appConfig);this.vent=new d.Object;if(this.actions){var b=this,c=_.isArray(this.actions)?this.actions:[this.actions];_.each(c,function(c){if(_.isFunction(c.initialize)){var a=c.initialize;delete c.initialize}c.events&&_.each(c.events,function(a,h){c[a]&&b.listenTo(b.vent,h,c[a])});_.extend(b,c);a&&a.call(b)});delete this.actions}this.afterInitialize()},afterInitialize:function(){},onBeforeStart:function(b){b||(b=
{});if(!b.$el)throw Error(this.appName+": missing $el (root DOM element) in options");this.config=f.extend(!0,this.config,b.config,b.$el.data());this.i18n=b.i18n||{};_.isUndefined(this.config.debugMode)&&(this.config.debugMode=!1);this.config.debugMode&&(window[this.appName]=this);if(!this.layout)throw Error(this.appName+": missing layout in application");if(_.isFunction(this.onBeforeDataInit))this.onBeforeDataInit(b);for(var c in this.data)if(this.data.hasOwnProperty(c)){if(this.data[c].hasOwnProperty("model")&&
this.data[c].hasOwnProperty("options")){var d=this.data[c].model;d=new d(this.data[c].options||{})}else d=new this.data[c];d.fetchImmediately&&d.url&&d.fetch({reset:!0});this.data[c]=d}this.layout=new this.layout({el:b.$el});_.isFunction(this._onBeforeStart)&&this._onBeforeStart(b)},onStart:function(b){this.layout.$el.removeClass(this.config.stateClass.loading).find(this.config.stateClass.loading).removeClass(this.config.stateClass.loading);_.isFunction(this._onStart)&&this._onStart(b)},run:function(){if(this._alreadyRun)return!1;
var b={};this.config.state&&(b.state=this.config.state);this.triggerMethod("run",b);return this._alreadyRun=!0},getText:function(b){if(this.i18nCache[b])return this.i18nCache[b];if(0<b.indexOf(".")){var c=this.i18n;for(var d=b.split("."),a=0;c&&a<d.length;)c=c[d[a++]]}else c=this.i18n[b];return c?this.i18nCache[b]=c:(f.log("AbstractApplication.getText: translation for the key '"+b+"' could not be found"),this.config.debugMode?b:"")}})});
define("abstracts/AbstractLayout",["require","marionette"],function(g){return g("marionette").LayoutView.extend({regions:{},views:{},initialize:function(){var f=this;this.triggerMethod("before:initialize");_.each(this.views,function(d,b){d.view?(d.options||(d.options={createInstance:!0}),f.addView(b,d.view,d.options)):f.addView(b,d,{createInstance:!0})});this.triggerMethod("initialize",arguments)},addView:function(f,d,b){var c;d.prototype.parentLayout=this;b.createInstance&&(c=new d(b));this.views[f]=
{view:d,options:b,instance:c}},get:function(f){return this.views.hasOwnProperty(f)?this.views[f].instance:null},set:function(f,d,b){b||(b={});var c=this,g=f;if(_.isString(f)){var a={};a[f]=d;g=a}else b=d||{};var k=void 0===b.unset?!0:b.unset,h=!!b.swap,q,l,t,e,r,w;this.triggerMethod("before:layout:change",g,b);_.each(this.regions,function(a,d){l=c.getRegion(d);if(g.hasOwnProperty(d)){r=g[d];if(_.isObject(r))if(e=r,e.key)if(e.view)c.views.hasOwnProperty(e.key)&&c.views[e.key].instance&&c.views[e.key].instance.destroy(b.destroyOptions),
c.views[e.key]=e;else{if(!c.views.hasOwnProperty(e.key))throw Error("could not find view with key '"+e.key+"'");a=e.showOptions;e=c.views[e.key];e.showOptions=a}else if(e.instance){if(e.instance.isDestroyed)throw Error("property `instance` holds an amiss view: '"+e+"'");}else{if(!e.view)throw Error("property `view` is missing: '"+r+"'");}else{if(!c.views.hasOwnProperty(r))throw Error("could not find view with key '"+r+"'");e=c.views[r]}t=l.hasView()&&(l.currentView.preventDestroy||!1===l.currentView.template);
e.instance&&e.instance.isDestroyed&&delete e.instance;e.instance||(q=e.view,e.instance=new q(e.options));t&&l.currentView.triggerMethod("before:detach");w=e.showOptions||{};w.preventDestroy=t;l[h?"swap":"show"](e.instance,w);t&&l.currentView.triggerMethod("detach")}else k&&(l.hasView()?((t=l.currentView.preventDestroy||!1===l.currentView.template)&&l.currentView.triggerMethod("before:detach"),l.empty(t),t&&l.currentView.triggerMethod("detach")):l.$el.contents().detach())});this.triggerMethod("layout:change",
g,b)}})});
(function(g,f){"function"===typeof define&&define.amd?define("uri-templates",[],f):"undefined"!==typeof module&&module.exports?module.exports=f():g.UriTemplate=f()})(this,function(){function g(a){return encodeURI(a).replace(/%25[0-9][0-9]/g,function(a){return"%"+a.substring(3)})}function f(a){a=a.replace(/%../g,"");return encodeURIComponent(a)===a}function d(a){var b="";c[a.charAt(0)]&&(b=a.charAt(0),a=a.substring(1));var d="",q="",l=!0,t=!1,e=!1;"+"==b?l=!1:"."==b?d=q=".":"/"==b?d=q="/":"#"==b?(q=
"#",l=!1):";"==b?(d=q=";",e=t=!0):"?"==b?(q="?",d="\x26",t=!0):"\x26"==b&&(d=q="\x26",t=!0);b=[];a=a.split(",");for(var r=[],w={},n=0;n<a.length;n++){var u=a[n],v=null;-1!=u.indexOf(":")&&(v=u.split(":"),u=v[0],v=parseInt(v[1]));for(var x={};p[u.charAt(u.length-1)];)x[u.charAt(u.length-1)]=!0,u=u.substring(0,u.length-1);v={truncate:v,name:u,suffices:x};r.push(v);w[u]=v;b.push(u)}return{varNames:b,prefix:q,substitution:function(a){for(var b="",c=0,k=0;k<r.length;k++){var m=r[k],f=a(m.name);if(null==
f||Array.isArray(f)&&0==f.length||"object"==typeof f&&0==Object.keys(f).length)c++;else if(b=k==c?b+q:b+(d||","),Array.isArray(f)){t&&(b+=m.name+"\x3d");for(var h=0;h<f.length;h++)0<h&&(b+=m.suffices["*"]?d||",":",",m.suffices["*"]&&t&&(b+=m.name+"\x3d")),b+=l?encodeURIComponent(f[h]).replace(/!/g,"%21"):g(f[h])}else if("object"==typeof f){t&&!m.suffices["*"]&&(b+=m.name+"\x3d");h=!0;for(var n in f)h||(b+=m.suffices["*"]?d||",":","),h=!1,b+=l?encodeURIComponent(n).replace(/!/g,"%21"):g(n),b+=m.suffices["*"]?
"\x3d":",",b+=l?encodeURIComponent(f[n]).replace(/!/g,"%21"):g(f[n])}else t&&(b+=m.name,e&&""==f||(b+="\x3d")),null!=m.truncate&&(f=f.substring(0,m.truncate)),b+=l?encodeURIComponent(f).replace(/!/g,"%21"):g(f)}return b},unSubstitution:function(a,b,c){q&&(a=a.substring(q.length));if(1==r.length&&r[0].suffices["*"]){for(var k=r[0],e=k.name,h=k.suffices["*"]?a.split(d||","):[a],g=l&&-1!=a.indexOf("\x3d"),n=1;n<h.length;n++)a=h[n],g&&-1==a.indexOf("\x3d")&&(h[n-1]+=(d||",")+a,h.splice(n,1),n--);for(n=
0;n<h.length;n++){a=h[n];l&&-1!=a.indexOf("\x3d")&&(g=!0);var m=a.split(",");h[n]=1==m.length?m[0]:m}if(t||g){n=b[e]||{};for(g=0;g<h.length;g++)if(k=a,!t||k){if("string"==typeof h[g]){a=h[g];m=a.split("\x3d",1)[0];a=a.substring(m.length+1);if(l){if(c&&!f(a))return;a=decodeURIComponent(a)}k=a}else{a=h[g][0];m=a.split("\x3d",1)[0];a=a.substring(m.length+1);if(l){if(c&&!f(a))return;a=decodeURIComponent(a)}h[g][0]=a;k=h[g]}if(l){if(c&&!f(m))return;m=decodeURIComponent(m)}void 0!==n[m]?Array.isArray(n[m])?
n[m].push(k):n[m]=[n[m],k]:n[m]=k}1==Object.keys(n).length&&void 0!==n[e]?b[e]=n[e]:b[e]=n}else{if(l)for(g=0;g<h.length;g++)if(m=h[g],Array.isArray(m))for(a=0;a<m.length;a++){if(c&&!f(m[a]))return;m[a]=decodeURIComponent(m[a])}else{if(c&&!f(m))return;h[g]=decodeURIComponent(m)}void 0!==b[e]?Array.isArray(b[e])?b[e]=b[e].concat(h):b[e]=[b[e]].concat(h):b[e]=1!=h.length||k.suffices["*"]?h:h[0]}}else{h=1==r.length?[a]:a.split(d||",");var p={};for(n=0;n<h.length;n++){for(e=0;e<r.length-1&&e<n&&!r[e].suffices["*"];e++);
if(e==n)p[n]=n;else{for(a=r.length-1;0<a&&r.length-a<h.length-n&&!r[a].suffices["*"];a--);p[n]=r.length-a==h.length-n?a:e}}for(n=0;n<h.length;n++)if((a=h[n])||!t){m=a.split(",");t?(a=m[0],e=a.split("\x3d",1)[0],a=a.substring(e.length+1),m[0]=a,k=w[e]||r[0]):(k=r[p[n]],e=k.name);for(g=0;g<m.length;g++)if(l){if(c&&!f(m[g]))return;m[g]=decodeURIComponent(m[g])}(t||k.suffices["*"])&&void 0!==b[e]?Array.isArray(b[e])?b[e]=b[e].concat(m):b[e]=[b[e]].concat(m):b[e]=1!=m.length||k.suffices["*"]?m:m[0]}}return 1}}}
function b(a){if(!(this instanceof b))return new b(a);for(var c=a.split("{"),h=[c.shift()],f=[],l=[],t=[],e=[];0<c.length;){var g=c.shift(),p=g.split("}")[0];g=g.substring(p.length+1);p=d(p);l.push(p.substitution);t.push(p.unSubstitution);f.push(p.prefix);h.push(g);e=e.concat(p.varNames)}this.fill=function(a){if(a&&"function"!==typeof a){var b=a;a=function(a){return b[a]}}for(var c=h[0],e=0;e<l.length;e++)c+=(0,l[e])(a),c+=h[e+1];return c};this.fromUri=function(a,b){b=b||{};for(var c={},l=0;l<h.length;l++){var e=
h[l];if(a.substring(0,e.length)!==e)return;a=a.substring(e.length);if(l>=h.length-1)if(""==a)break;else return;e=f[l];if(!e||a.substring(0,e.length)===e){e=h[l+1];for(var k=l;;){if(k==h.length-2){k=a.substring(a.length-e.length);if(k!==e)return;e=a.substring(0,a.length-e.length);a=k}else if(e)k=a.indexOf(e),e=a.substring(0,k),a=a.substring(k);else if(f[k+1])k=a.indexOf(f[k+1]),-1===k&&(k=a.length),e=a.substring(0,k),a=a.substring(k);else if(h.length>k+2){k++;e=h[k+1];continue}else e=a,a="";break}if(!t[l](e,
c,b.strict))return}}return c};this.varNames=e;this.template=a}var c={"+":!0,"#":!0,".":!0,"/":!0,";":!0,"?":!0,"\x26":!0},p={"*":!0};b.prototype={toString:function(){return this.template},fillFromObject:function(a){return this.fill(a)},test:function(a,b){return!!this.fromUri(a,b)}};return b});
define("abstracts/utils",["require","jquery"],function(g){var f=g("jquery"),d=function(){var b=document.createElement("div"),c={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},d;for(d in c)if(void 0!==b.style[d])return c[d];return!1}();return{animate:function(b,c){var g=f.Deferred();d?(b.on(d,function(){b.removeClass(c);g.resolve()}),b.addClass(c)):(b.addClass(c),setTimeout(function(){b.removeClass(c);g.resolve()},
500));return g},camelCaseToObject:function(b,c,d){d||(d={});var a=d,k=b.split(/(?=[A-Z])/),h=k.length;if(1<h){for(b=0;b<h-1;b++){var f=k[b].toLowerCase();a[f]||(a[f]={});a=a[f]}a[k[h-1].toLowerCase()]=c}else a[b]=c;return d},dataToJson:function(b){b=b.data()||{};var c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];delete b[c];this.camelCaseToObject(c,d,b)}return b},mixin:function(b){if(b.mixin){_.isArray(b.mixin)||(b.mixin=[b.mixin]);var c={},d=function(a){return function(){for(var b=Array.prototype.slice.call(arguments),
c=0,d=a.length;c<d;c++)a[c].apply(this,b)}};_.each(b.mixin,function(a){_.each(a,function(k,h){if("mixinOverride"!==h)if(!b[h]||a.mixinOverride&&-1!==a.mixinOverride.indexOf(h))b[h]=k;else if(_.isFunction(k))if(c[h])c[h].push(k);else if(_.isFunction(b[h])){var g=b[h];c[h]=[];c[h].push(g,k);b[h]=d(c[h])}else b[h]=k;else _.isObject(k)?b[h]=f.extend(!0,b[h],k):b[h]=k})});return b}},copyToClipBoard:function(b){var c=document.createElement("textarea");c.value=b;c.setAttribute("readonly","");c.style.position=
"absolute";c.style.left="-9999px";document.body.appendChild(c);c.select();document.execCommand("copy");document.body.removeChild(c);document.execCommand("copy")}}});define("abstracts/mixinFwdEvents",[],function(){return{fwd:function(g,f){f=f||{};this.listenTo(g,"all",function(){var d=Array.prototype.slice.call(arguments),b=d.shift();f.prefix&&(b=f.prefix+":"+b);f.suffix&&(b=b+":"+f.suffix);d.unshift(b);this.trigger.apply(this,d)},this)}}});
define("abstracts/HALModel","require jquery uri-templates backbone ./utils ./mixinFwdEvents".split(" "),function(g){var f=g("jquery"),d=g("uri-templates"),b=g("backbone"),c=g("./utils");g=g("./mixinFwdEvents");var p=b.Model.extend(c.mixin({isHALModel:!0,mixin:[g],recursiveModels:!1,_resource:null,host:"",alias:{},aliasOnly:!1,linkedModelEventPrefix:"link:",_linkModelEvents:{request:"",sync:"",error:""},_dfd:f.Deferred(),constructor:function(a,c){c||(c={});c.parse=!0;"boolean"===typeof c.recursiveModels&&
(this.recursiveModels=c.recursiveModels);this.parent=c.parent;b.Model.prototype.constructor.call(this,a,c);this.linkModelEvents&&(this._linkModelEvents=_.extend(this._linkModelEvents,this.linkModelEvents));c.resource&&this.resource(c.resource);c.host&&(this.host=c.host)},resource:function(a){if(!a)return this._resource;_.isString(a)&&(a={href:a});this._resource=a;return this},hasResource:function(){return!!this._resource&&!f.isEmptyObject(this._resource)},reset:function(a){a=this.parse(a);this.set(a,
{silent:!0});this.trigger("reset",this);return this},clear:function(a){this._embedded={};this._links={};return b.Model.prototype.clear.call(this,a)},fetch:function(a){a||(a={});(a.resource||a.url)&&this.resource(a.resource||a.url);a.host||(a.host=this.host);if(this._resource&&(a.url=a.host+this._resource.href,this._resource.templated)){var c=new d(a.url);a.url=c.fillFromObject(a.tokens||{})}return b.Model.prototype.fetch.call(this,a)},parse:function(a){a||(a={});for(var b in this.alias)if(this.alias.hasOwnProperty(b)){var c=
this.alias[b];a._links&&a._links[b]&&(a._links[c]=a._links[b],this.aliasOnly&&delete a._links[b]);a._embedded&&a._embedded[b]&&(a._embedded[c]=a._embedded[b],this.aliasOnly&&delete a._embedded[b])}this._parseLinks(a._links||{});delete a._links;_.isFunction(this.parseLinks)&&(this._links=this.parseLinks(this._links,a));this._embedded=this.parseEmbedded(a._embedded||{},a);delete a._embedded;return this.parseData(a)},parseData:function(a){return a},_deferenceLinkedModels:function(){if(this.hasLinks())for(var a in this._links)"self"!==
a&&this._links.hasOwnProperty(a)&&_.isFunction(this._links[a].off)&&(this.stopListening(this._links[a]),delete this._links[a])},_parseLinks:function(a){this._deferenceLinkedModels();a.self&&(this.resource(a.self),delete a.self);this._links=a;if(!this.recursiveModels)return a;for(var b in a)a.hasOwnProperty(b)&&(a[b]=new p({},{resource:a[b],parent:this,recursiveModels:this.recursiveModels}),this.fwd(a[b],{prefix:this.linkedModelEventPrefix}),this.fwd(a[b],{prefix:this.linkedModelEventPrefix,suffix:b}));
return a},parseEmbedded:function(a){if(this.recursiveModels)for(var b in a)a.hasOwnProperty(b)&&(a[b]=new p(a[b],{parent:this,recursiveModels:this.recursiveModels}));return a},embed:function(a,b,c){var d={};_.isString(a)?d[a]=b:(d=a,c=b);c||(c={});this._embedded||(this._embedded={});for(var l in d)d.hasOwnProperty(l)&&(_.isObject(d[l])&&d[l].isHALModel&&(d[l]=d[l].toJSON({embedded:!0,links:!0})),this._embedded[l]=d[l]);c.silent||this.trigger("embedded:change",this,c);return this},hasEmbedded:function(a){return this._embedded?
a?this._embedded.hasOwnProperty(a):!this._embedded&&!f.isEmptyObject(this._embedded):!1},embeddedKeys:function(){return this.hasEmbedded()?_.keys(this._embedded):[]},embeddedItem:function(a,b){return a&&this.hasEmbedded(a)?_.isArray(this._embedded[a])?(b=b&&b.at?b.at:0,this._embedded[a].length>b?this._embedded[a][b]:null):this._embedded[a]:null},embeddedItems:function(a){return a&&this.hasEmbedded(a)?_.isArray(this._embedded[a])?this._embedded[a]:[this._embedded[a]]:[]},embeddedModel:function(a,b){return a&&
this.hasEmbedded(a)?_.isArray(this._embedded[a])?(b=b&&b.at?b.at:0,this._embedded[a].length>b?this.toModel(this._embedded[a][b]):null):this.toModel(this._embedded[a]):null},embeddedModels:function(a){return a&&this.hasEmbedded(a)?_.isArray(this._embedded[a])?_.map(this._embedded[a],this.toModel,this):[this.toModel(this._embedded[a])]:[]},toModel:function(a){return a.isHALModel?a:new p(_.clone(a))},toModelByResource:function(a){return a.isHALModel?a:new p({},{resource:a})},toList:function(a){return _.isUndefined(a)||
_.isNull(a)?[]:_.isArray(a)?a:[a]},toObject:function(a){return _.isUndefined(a)||_.isNull(a)?{}:_.isArray(a)&&0<a.length?a[0]:a},link:function(a,b){b||(b=null);return this.hasLink(a)?_.isArray(this._links[a])?0<this._links[a].length?this._links[a][0]:b:this._links[a]:b},hasLink:function(a){return this._links&&this._links.hasOwnProperty(a)},links:function(a){return this.hasLinks()?a?this.hasLink(a)?_.isArray(this._links[a])?_.clone(this._links[a]):[_.clone(this._links[a])]:null:_.clone(this._links):
null},hasLinks:function(){return!this._links||!f.isEmptyObject(this._links)},linkedModel:function(a,b){return a&&this.hasLink(a)?_.isArray(this._links[a])?(b=b&&b.at?b.at:0,this._links[a].length>b?new p({},{resource:this._links[a][b]}):null):new p({},{resource:this._links[a]}):null},linkedModels:function(a){return a&&this.hasLink(a)?_.isArray(this._links[a])?_.map(this._links[a],this.toModelByResource,this):[this.toModelByResource(this._links[a])]:null},setLinks:function(a,b,c){var d={};_.isString(a)?
d[a]=b:(d=a,c=b);c||(c={});d&&d.self&&delete d.self;this._links=d;c.silent||this.trigger("links:change",this,c);return this},toJSON:function(a){a||(a={});var b=_.clone(this.attributes);a.embedded&&this.hasEmbedded()&&(b._embedded=this._embedded);a.links&&this.hasLinks()&&(b._links=this._links);return b}}));p.extend=b.Model.extend;return p});
define("abstracts/AbstractOverlay",["require","jquery","marionette","./HALModel"],function(g){var f=g("jquery"),d=g("marionette");g=g("./HALModel");var b=d.ItemView.extend({template:!1,className:"by_cc_overlay",_ui:{close:".by_cc_js_overlay_close"},_abstractEvents:{"click @ui.close":"closeOverlay"},eventName:"overlay",useTransition:!0,useObserver:!0,observerOptions:{},enableEscKey:!0,disableAutoFetch:!1,disableAutoRender:!1,disableAutoCloseOnRoute:!1,modelObject:g,noScrollClass:"by_cc_overlay_noscroll",
_eventIdSuffix:"-ao",_doc:f(document),_body:f("body"),_htmlBody:f("html, body"),_parentEl:null,_contentLoaded:!1,_validModel:!1,constructor:function(b){this.ui=f.extend({},this._ui,this.ui);this.events=f.extend({},this._abstractEvents,this.events||{});d.ItemView.call(this,b)},initialize:function(b){b||(b={});if(this.onBeforeInitialize)this.onBeforeInitialize(b);this._parentEl=b.parent?b.parent:this.appInstance.layout.$el;if(b.region){var c=this.appInstance.layout.getRegion(b.region);c&&(this._parentEl=
c.$el)}_.isString(this._parentEl)&&(this._parentEl=this.appInstance.layout.$el.find(this._parentEl));!this.model&&b.resource&&(this.model=new this.modelObject,this.model.resource(b.resource));this._triggerEvent("init");this._doc.on(bm.config.breakPoints.eventName+"."+this.cid+this._eventIdSuffix,this._bpChange.bind(this));if(this.onInitialized)this.onInitialized(b);(this.validModel=this.model&&_.isFunction(this.model.hasResource)&&this.model.hasResource())&&this.useObserver&&this.appInstance.observer.addModel(this.model,
this.observerOptions);b.disableAutoFetch||this.disableAutoFetch||!this.validModel?this._isRendered||b.disableAutoRender||this.disableAutoRender||this._renderContent():this._loadContent(b);b.disableAutoCloseOnRoute||this.disableAutoCloseOnRoute||this.listenTo(this.appInstance.state,"route",function(){this.closeOverlay()})},_renderContent:function(){var b=this;this._contentLoaded=!0;this.render();this.$el.prependTo(this._parentEl);this._fixedBody();b.triggerMethod("attach");this.useTransition?(this.$el.hide(),
this.$el.fadeIn(function(){b.triggerMethod("animate:show")})):b.triggerMethod("animate:show")},_loadContent:function(b){this._contentLoaded=!1;this.listenTo(this.model,"sync",this._renderContent);this.model.fetch(b)},_triggerEvent:function(b){this.appInstance.vent.trigger(this.eventName+":"+b,{overlay:this,parent:this._parentEl,model:this.model})},_onKeyUp:function(b){if(this.onBeforeKeyUp)this.onBeforeKeyUp(b);27===b.keyCode&&this.destroy();if(this.onKeyUp)this.onKeyUp(b)},disableKeys:function(){this._doc.off("keyup."+
this.cid+this._eventIdSuffix)},enableKeys:function(){this._doc.off("keyup."+this.cid+this._eventIdSuffix).on("keyup."+this.cid+this._eventIdSuffix,this._onKeyUp.bind(this))},render:function(){var b=_.toArray(arguments);this._onRender(b);return d.ItemView.prototype.render.apply(this,b)},_onRender:function(){this.$el.toggleClass(this.appInstance.config.stateClass.loading,!this._contentLoaded);this._contentLoaded?(this.ui.close&&0<this.ui.close.length&&this.enableEscKey&&this.enableKeys(),this._triggerEvent("show")):
this._triggerEvent("loading")},_onDestroy:function(){!this._contentLoaded&&f.isFunction(this.model.abortRequest)&&this.model.abortRequest();this.validModel&&this.useObserver&&this.appInstance.observer.removeModel(this.model);this._doc.off("keyup."+this.cid+this._eventIdSuffix);this._doc.off(bm.config.breakPoints.eventName+"."+this.cid+this._eventIdSuffix);this._triggerEvent("close")},destroy:function(){var b=this,f=_.toArray(arguments);this._releaseFixedBody();this._onDestroy();this.useTransition?
(this.triggerMethod.apply(this,["animate:destroy"].concat(f)),this.$el.fadeOut(function(){d.ItemView.prototype.destroy.apply(b,f)})):d.ItemView.prototype.destroy.apply(b,f)},closeOverlay:function(b){b&&b.preventDefault&&b.preventDefault();this.destroy()},_bpChange:function(){var c=this._isFixed();null===b._scrollPosition&&c?this._fixedBody():null===b._scrollPosition||c||this._releaseFixedBody()},_isFixed:function(){return"fixed"===this.$el.css("position")},_fixedBody:function(){this._isFixed()&&(b.numberFixed++,
1===b.numberFixed&&(b._scrollPosition=this._doc.scrollTop(),this._body.addClass(this.noScrollClass),this._body.css("margin-top",-1*b._scrollPosition)))},_releaseFixedBody:function(){b.numberFixed=Math.max(b.numberFixed-1,0);null!==b._scrollPosition&&0===b.numberFixed&&(this._body.removeClass(this.noScrollClass),this._body.removeAttr("style"),this._htmlBody.scrollTop(b._scrollPosition),b._scrollPosition=null)}},{numberFixed:0,_scrollPosition:null});return b});
define("abstracts/mixinModelDeps",["require","jquery"],function(g){var f=g("jquery");return{mixinOverride:["fetch"],initialize:function(){this.mixinBackboneFetch=this.model?Backbone.Collection.prototype.fetch:Backbone.Model.prototype.fetch},fetch:function(d){f.log("mixinModelDeps.fetch begin",d,this.deps,this.depSource);d||(d={});var b=Array.prototype.slice.call(arguments),c=d.deps||this.deps,g=d.error;if(!_.isArray(c))return this.mixinBackboneFetch.apply(this,arguments);for(var a=0,k=c.length;a<
k;a++)_.isString(c[a])&&(c[a]=this.depSource[c[a]]);var h=this,q=new f.Deferred;c=_.invoke(c,"getXhr",{invoke:!0});f.when.apply(f.when,c).done(function(){f.log("mixinModelDeps.fetch: dependencies loaded",arguments);var a=h.mixinBackboneFetch.apply(h,b);a.done(q.resolve);a.fail(q.reject)}).fail(function(a){f.log("mixinModelDeps.fetch: ERROR during loading dependencies",arguments);g&&g(h,a,d);h.trigger("error",h,a,d);q.reject.apply(q.reject,arguments)});return q.promise()}}});
define("abstracts/mixinModelXhr",["require","jquery"],function(g){var f=g("jquery");return{mixinOverride:["sync"],xhr:void 0,xhrErrorCtx:void 0,xhrMethod:void 0,xhrOptions:{},initialize:function(){this.mixinBackboneSync=this.model?Backbone.Collection.prototype.sync:Backbone.Model.prototype.sync;this.listenTo(this,"request cacherequest",function(d,b){this.xhr=b})},sync:function(d,b,c){var f=this;this.xhrOptions=c||{};this.xhrMethod=d;this.xhrErrorCtx=void 0;var a=c.beforeSend;c.beforeSend=function(){f.abortRequest();
a&&a.apply(this,arguments)};var g=c.error;c.error=function(a){f.xhrErrorCtx=this;g(f,a,c)};return this.mixinBackboneSync(d,b,c)},abortRequest:function(){this.xhr&&4>this.xhr.readyState&&this.xhr.abort()},getXhr:function(d){d||(d={});return this.hasXhrError()?this.retry():this.hasXhr()?this.xhr:d.invoke?this.fetch(d):null},hasXhr:function(){return!!this.xhr},hasXhrError:function(){return!!this.xhr&&4===this.xhr.readyState&&400<=this.xhr.status},retry:function(){f.log("mixinModelXhr.retry",this,this.xhr);
return this.xhrErrorCtx?Backbone.ajax(this.xhrErrorCtx):this.xhrMethod?this.sync(this.xhrMethod,this,this.xhrOptions):null}}});
(function(g,f){if("function"===typeof define&&define.amd)define("abstracts/StateRouter",["backbone","underscore","jquery"],function(b,a,c){g.StateRouter=f(g,b,a,c);return g.StateRouter});else if("undefined"!==typeof exports){var d=require("backbone"),b=require("underscore"),c=require("jquery");module.exports=f(g,d,b,c)}else g.StateRouter=f(g,g.Backbone,g._,g.fra_jquery)})(this,function(g,f,d,b){var c={},p={multiApp:!1,usePushState:!1,baseUrl:void 0,saveAllStates:!1,eventPrefix:"state:",pathDivider:"/",
divider:"/",keyValueDivider:"/",valueDivider:","},a={_placeholder:"*state",init:function(c){a.config=b.extend({},p,c);f.history.start({pushState:a.config.usePushState,root:a.config.baseUrl,silent:!0})},VERSION:"1.0.0",encodeProp:function(a,c){a=void 0;switch(b.type(c)){case "boolean":if(c)return!0;break;case "number":a=c.toString();break;case "string":a=encodeURIComponent(c);break;case "array":a=d.map(c,encodeURIComponent).join(this.valueDivider);break;case "date":a=encodeURIComponent(c.toISOString());
break;case "object":a=base64url.encode(JSON.stringify(c))}return a},decodeProp:function(a,c,e){a=void 0;switch(e){case "boolean":a=!!c;break;case "number":a=parseFloat(c);break;case "string":a=decodeURIComponent(c);break;case "array":a=d.map(c.split(this.valueDivider),decodeURIComponent);break;case "date":a=(c=Date.parse(decodeURIComponent(c)))?new Date(c):void 0;break;case "object":try{a=JSON.parse(base64url.decode(c))}catch(r){b.log("[error] Staterouter.decodeProp",r,c)}}return a},navigate:function(l,
g){var e="";a.config.saveAllStates&&d.each(c,function(c,d){c.stateName!==d&&b.isString(c.fragment)&&0<c.fragment.length&&(e+=a.config.pathDivider+c.fragment)});e+=a.config.pathDivider+l.fragment;f.history.navigate(e,g)}},k=function(b,f){return function(){var e=Array.prototype.slice.call(arguments);d.each(c,function(c,d){b!==d?(c.model.trigger.apply(c.model,[b+":"+f].concat(e)),c.model._stream&&c.model._stream.trigger.apply(c.model._stream,[b+":"+a.config.eventPrefix+f].concat(e))):c.model._stream&&
c.model._stream.trigger.apply(c.model._stream,[a.config.eventPrefix+f].concat(e))})}},h=f.Model.extend({_stream:void 0,initialize:function(a,b){this.currentProps=b.currentProps},connectWith:function(a,c){if(!b.isFunction(a.trigger))return!1;this._stream=a;this._streamOptions=c||{}},disconnect:function(){this._stream&&(b.isFunction(this._stream.stopListening)&&this._stream.stopListening(this),this._stream=null)},navigate:function(a,b){b||(b={});d.isUndefined(b.trigger)&&(b.trigger=!0);this.trigger("navigate",
a,b)},isEmpty:function(){return b.isEmptyObject(this.attributes)},destroy:function(){this.trigger("destroy");this.disconnect();this.off()},getCurrentProps:function(){return this.currentProps()},reload:function(){this.trigger("route",this.attributes,!1)},clear:function(a){if(a&&a.exclude){for(var b={},c=!1,d,l=0,g=a.exclude.length;l<g;l++)d=a.exclude[l],this.attributes[d]&&(b[d]=this.attributes[d],c=!0);d=a.silent;a.silent=d||c;f.Model.prototype.clear.call(this,a);c&&(a.silent=d,this.set(b,a))}else f.Model.prototype.clear.call(this,
a);return this},reset:function(a,c,e){if(!a)return this;if("object"===typeof a){var d=a;e=c}else(d={})[a]=c;e||(e={});a=e.silent;c=!b.isEmptyObject(d);e.silent=a||c;this.clear(e);c&&(e.silent=a,this.set(d,e));!1!==e.reload&&this.reload();return this}}),q=function(b,c,e){e||(e={});var g=this;this.defaults={};this.types={};d.each(c,function(a,b){var c=a;d.isString(a)&&(c={dataType:a});c.defaults&&(g.defaults[b]=c.defaults);g.types[b]=c});this.fragment="";this.useJson=!!e.useJson;this.stateName=b.toLowerCase();
this.route=(a.config.multiApp?this.stateName+a.config.divider:"")+a._placeholder;this.router=new f.Router;this.model=new h(this.defaults,{currentProps:this.getCurrentProps.bind(this)});this.bind();this.router.route(this.route,d.bind(this.analyzeRoute,this))};q.prototype={bind:function(){var b=this;this.model.on("change",d.bind(this.onModelChanged,this));this.model.on("change",function(a,c){a.hasChanged()&&!c.disablePiping&&(d.each(a.changed,function(d,e){k(b.stateName,"change:"+e)(a.attributes[e],
a.changed[e],c)}),k(b.stateName,"change")(a.attributes,a.changed,c))});this.model.on("route",k(b.stateName,"route"));this.model.on("destroy",k(b.stateName,"destroy"));this.model.on("navigate",function(b,c){a.config.usePushState&&(b=b.replace(g,""));f.history.navigate(b,c)})},onModelChanged:function(b,c){b.hasChanged()&&!c.disableRouting&&(b=this.buildFragment(),d.isEqual(b,this.fragment)||(this.fragment=b,a.navigate(this,c)))},getCurrentProps:function(){var a=f.history.getFragment();return this.extractProperties(a)},
extractProperties:function(c){var f={},e=this,g=a.config.divider===a.config.keyValueDivider;if(!a.config.keyValueDivider||this.useJson)try{f=JSON.parse(c)}catch(m){b.log("could not parse: ",c,m),f={}}else if(g){var l,h=0,k=0,p=c.split(a.config.divider);d.each(p,function(b,c){h=c;e.types[b]&&(l&&(f[l]=!0,k+1!==c&&(q=p.slice(k+1,c).join(a.config.divider),f[l]=e._decodeProp(l,q))),k=c,l=b)});if(l&&(f[l]=!0,k!==h)){var q=p.slice(k+1,h+1).join(a.config.divider);f[l]=e._decodeProp(l,q)}}else d.each(c.split(a.config.divider),
function(b){if(b.indexOf(a.config.keyValueDivider)){var c=b.split(a.config.keyValueDivider);b=c.shift();c=c.join(a.config.keyValueDivider);(c=e._decodeProp(b,c))&&(f[b]=c)}else f[b]=!0});return f},_decodeProp:function(b,c){var e=this.types[b];if(e&&(b=e.decode?e.decode(c):a.decodeProp(b,c,e.dataType),!e.validate||(d.isFunction(e.validate)?e.validate(b):e.validate.test(b))))return b},analyzeRoute:function(b){b&&b.charAt(b.length-1)===a.config.divider&&(b=b.slice(0,-1));this.fragment=f.history.getFragment();
b?(b=this.extractProperties(b),this.model.clear({silent:!0}),this.model.set(b,{silent:!0}),this.model.trigger("route",this.model.attributes,this.model.hasChanged()?this.model.changed:!1,!!location.search)):(this.model.clear({silent:!0}),this.model.trigger("route",!1,this.model.hasChanged()?this.model.changed:!1))},buildFragment:function(){var b=this,c=a.config.multiApp?this.stateName+a.config.divider:"",e,f=!0;d.each(this.model.attributes,function(g,h){e=b.types[h]&&d.isFunction(b.types[h].encode)?
b.types[h].encode(g):b.types[h]&&!1!==b.types[h].encode?a.encodeProp(h,g):g;d.isUndefined(e)||(f||(c+=a.config.divider),c+=h,f=!1,e&&(c+=a.config.keyValueDivider+e))});return c}};a.create=function(a,b,d){if(c.hasOwnProperty(a))return!1;a=new q(a,b,d);c[a.stateName]=a;return a.model};a.check=function(){return f.history.loadUrl()};return a});
define("abstracts/main","require ./AbstractApplication ./AbstractLayout ./AbstractOverlay ./HALModel ./mixinFwdEvents ./mixinModelDeps ./mixinModelXhr ./StateRouter".split(" "),function(g){g("./AbstractApplication");g("./AbstractLayout");g("./AbstractOverlay");g("./HALModel");g("./mixinFwdEvents");g("./mixinModelDeps");g("./mixinModelXhr");g("./StateRouter")});